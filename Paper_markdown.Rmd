---
output: 
  pdf_document:
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: pdflatex
    template: svm-latex-ms2.tex
title: "Global Reach or Out of Reach"
author: 
- name: Addison Huygens
  affiliation: University of Iowa
abstract: "Here's where you write 100 to 250 words, depending on the journal, that describe your objective, methods, results, and conclusion."
keywords: "Naval power hegemony"
date: "May 10, 2019"
fontsize: 12pt
spacing: single
bibliography: \dummy{`r file.path(getwd(), list.files(getwd(), "bib$"))`}
biblio-style: apsr
citecolor: black
linkcolor: black
endnote: no
---



Test

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(tidyverse)
library(DataCombine)
library(haven)
library(dotwhisker)
library(data.table)
library(mlogit)
library(ggplot2)
library(margins)
library(nnet)
library(reshape2)

```


```{r, include=FALSE, cache=TRUE}

#Data generation process 
#Prepping datasets for merging.

dyadic_mid_3_1_may_2018 <- as.data.frame( read_dta("C:/Users/packe/Documents/Methods_3/Paper/Datasets/dyadic_mid_3.1_may_2018.dta"))
View(dyadic_mid_3_1_may_2018)

#Renaming variables in MIDs data
Dyadic_MID <- dyadic_mid_3_1_may_2018 %>%
  rename(
    ccodea = statea,
    ccodeb = stateb
  ) 
Dyadic_MID <- select(Dyadic_MID, ccodea, ccodeb, year, hihost)
view(Dyadic_MID)


#Relative capabilities data
NMC_5_0 <- as.data.frame(read_dta("C:/Users/packe/Documents/Methods_3/Paper/Datasets/NMC_5_0.dta"))
View(NMC_5_0)
NMC <- select(NMC_5_0, ccode, year, irst, milex, milper, pec, tpop, upop, cinc)
NMCA <- NMC %>%
  rename(
    ccodea = ccode,
    irsta = irst,
    milexa = milex,
    milpera = milper,
    peca = pec,
    tpopa = tpop,
    upopa = upop,
    cinca = cinc
  ) 
NMCA
  
NMCB <- NMC %>%
  rename(
    ccodeb = ccode,
    irstb = irst,
    milexb = milex,
    milperb = milper,
    pecb = pec,
    tpopb = tpop,
    upopb = upop,
    cincb = cinc
  ) 
NMCB


#Importing naval data, removing all but the data for the U.S., keeping only relevant variables.
crisher_souva_navaldata_II <- as.data.frame(read_dta("C:/Users/packe/Documents/Methods_3/Paper/Datasets/crisher_souva_navaldata_II.dta"))
Naval1 <- filter(crisher_souva_navaldata_II, cowcode == 2)
Naval2 <- select(Naval1, year, totton, tonn_prop, milex, milper)
USNaval <- Naval2 %>%
  rename(
    ustoton = totton,
    ustonn_prop = tonn_prop,
    usmilex = milex,
    usmilper = milper,
  )  
view(USNaval)
  
  
#Importing PolityIV data and creating two seperate datasets to apply to both members of the dyad.
PolityIV <- as.data.frame(read_dta("C:/Users/packe/Documents/Methods_3/Paper/Datasets/PolityIV.dta"))

PolityIV1 <- select(PolityIV, year, ccode, democ, autoc, polity, polity2)
PolityIVa <- PolityIV1 %>%
  rename(
    ccodea = ccode,
    democa = democ,
    autoca = autoc,
    polity2a = polity2
  ) 
view(PolityIVa)

PolityIVb <- PolityIV1 %>%
  rename(
    ccodeb = ccode,
    democb = democ,
    autocb = autoc,
    polity2b = polity2
  ) 
PolityIVb


Alliance <- as.data.frame(read_dta("C:/Users/packe/Documents/Methods_3/Paper/Datasets/alliance_v4.1_by_directed_yearly.dta"))
Alliance <- Alliance %>%
  rename(
    ccodea = ccode1,
    ccodeb = ccode2, 
  )
  
Alliance <- select(Alliance, ccodea, ccodeb, year, defense, neutrality, nonaggression, entente)
view(Alliance)


politically_relevant <- as.data.frame(read_dta("C:/Users/packe/Documents/Methods_3/Paper/Datasets/politically_relevant.dta"))
view(politically_relevant)

Master <- politically_relevant %>%
  rename(
    ccodea = ccode1,
    ccodeb = ccode2, 
  ) 
view(Master)

```




```{r, include=FALSE, cache=TRUE}

#Merging datasets


#mergin in dyadic mid data
Master2 <- merge(Master, Dyadic_MID, by=c("ccodea", "ccodeb", "year"), all.x = TRUE, all.y = TRUE)

Master2 <- merge(Master2, Alliance, by=c("ccodea", "ccodeb", "year"), all.x = TRUE)

#Merging in polity iv datasets a and b.

Master2 <- merge(Master2, PolityIVa, by=c("ccodea", "year"), all.x = TRUE)

Master2 <- merge(Master2, PolityIVb, by=c("ccodeb", "year"), all.x = TRUE)

#merging in data on US naval capabilities

Master2 <- merge(Master2, USNaval, by=c("year"), all.x = TRUE)

plot(Naval2$year, Naval2$totton, main="US Naval Capabilities Over Time",
    xlab = "Year", ylab = "US Naval Capabilities", lines(lowess(Naval2$year,Naval2$totton), col="blue"))

#merging in data on material capabilities
Master2 <- merge(Master2, NMCA, by=c("ccodea", "year"), all.x = TRUE)

Master2 <- merge(Master2, NMCB, by=c("ccodeb", "year"), all.x = TRUE)


Master3 <- filter(Master2, ccodea != 2, ccodeb != 2, year < 2012, year >= 1950)
summary(Master3)
```



```{r, include=FALSE, cache=TRUE}
#Variable Generation

#Creating a variable which only identifies if a mid occured in that dyad-year
Master3 <- Master3 %>%
    mutate(Mid = ifelse(is.na(hihost), 0, 1))
summary(Master3$Mid)

#Creating a variable which only identifies if a Mid which involved the use of force occured in that dyad-year.
Master3 <- Master3 %>%
    mutate(Use_Force = ifelse(hihost > 3, 1, 0))
Master3$Use_Force[is.na(Master3$Use_Force)] <- 0
summary(Master3$Use_Force)
ftable(Master3$Use_Force)
 

Master3$Hostility[is.na(Master3$hihost)] <- 0 
Master3$Hostility[Master3$hihost==2] <- 1 
Master3$Hostility[Master3$hihost==3] <- 2 
Master3$Hostility[Master3$hihost==4] <- 3 
Master3$Hostility[Master3$hihost==5] <- 4 
ftable(Master3$Hostility)

#Creating variable identifying joint democracy
Master3 <- Master3 %>%
    mutate(Joint_Dem = ifelse(polity2a >= 6 & polity2b >=6, 1, 0))
head(Master3$Joint_Dem, 1000)

#Creating variable measuring relative capabilities
Master3 <- filter(Master3, cinca != -9, cincb != -9)
Master3 <- Master3 %>%
    mutate(Relative_Cap = (cinca/cincb)/100000)
head(Master3$Relative_Cap, 1000)

#Creating variable identifying if at least one member of the dyad is a major power.
Master3 <- Master3 %>%
    mutate(Major = ifelse(majpow1 == 1 | majpow2 == 1, 1, 0))
head(Master3$Major, 1000)

#Creating a variable identifying if the dyad had experienced a MID in the previous five years.
Master3$Lag_Mid <- lag(Master3$Mid, 5)

#Variable identfying the presence of an alliance between the two members of the dyad
Master3 <- Master3 %>%
    mutate(Ally =0)
Master3$Ally[Master3$neutrality==1] <- 1 
Master3$Ally[Master3$nonaggression==1] <- 1 
Master3$Ally[Master3$defense==1] <- 1 
Master3$Ally[Master3$entente==1] <- 1 


#Variable identifying if the two members of the dyad are in the same region
Master3 <- Master3 %>%
    mutate(Same_Region = ifelse(region1 == region2, 1, 0))
head(Master3$Same_Region, 1000)

#Creating a naval capability variable by modifying the systemic proportion of naval tonnage held by the US
Master3 <- Master3 %>%
    mutate(US_Naval_Cap =(usmilex/usmilper)*ustonn_prop) 
Master3 <- Master3 %>%
    mutate(US_Naval_Cap = (US_Naval_Cap/10000)) 
head(Master3$US_Naval_Cap, 1000)

plot(Master3$year, Master3$US_Naval_Cap, main="US Naval Capabilities Over Time",
    xlab = "Year", ylab = "US Naval Capabilities", lines(lowess(Master3$year,Master3$US_Naval_Cap), col="blue"))


#Binary variable identifying if the dyad year is during or after the Cold War
Master3 <- Master3 %>%
    mutate(Post_Cold_War = ifelse(year > 1990, 1, 0)) 

Master3 <- Master3 %>%
  rename(
    Contiguous = contig
  ) 

Master4 <- select(Master3, ccodea, ccodeb, year, Mid, Use_Force, Hostility, US_Naval_Cap, Same_Region, Contiguous, Joint_Dem, Relative_Cap, Major, Post_Cold_War, Lag_Mid, Ally)
summary(Master4)
```


```{r, include=FALSE, cache=TRUE}

#Statistical Tests

#Bivariate Logits
MID_BI_Log <- glm(Mid ~ US_Naval_Cap, data = Master4, family=binomial)
summary(MID_BI_Log)
ODDS_BI_MID <- exp(coef(MID_BI_Log))
dwplot(MID_BI_Log)


Force_BI_Log <- glm(Use_Force ~ US_Naval_Cap, data = Master4, family=binomial)
summary(Force_BI_Log)
ODDS_BI_FORCE <- exp(coef(Force_BI_Log))
dwplot(Force_BI_Log)


```



